# DOS CALL

## dos_chdir
コマンドライン引数で指定したパス名に、カレントディレクトリを`DOS _CHDIR`で変更し、
戻り値(エラーコード)を表示します。


## dos_chgdrv
コマンドライン引数で指定したドライブ(A～Z、a～z)に、
カレントドライブを`DOS _CHGDRV`で変更し、戻り値(エラーコード)を表示します。
ドライブ名の代わりに`@`を指定すると、`DOS _CHGDRV`の引数に`-1`を渡します(必ずエラーになります)。


## dos_conctrl
`DOS _CONCTRL`でコンソールの制御または直接出力を行います。  

コマンドライン引数でコントロールモード(10進数、0～18)を指定します。
追加の引数が必要なファンクションはスペースで区切って書いてください。

> [!WARNING]
> MD=16でグラフィック画面を使用する画面モードに設定する際、グラフィック画面が使用中か
> どうかは調べないので注意してください。


## dos_create_sp
コマンドライン引数で指定したファイルを`DOS _CREATE`の通常モードと特殊モード
(ファイル属性のビット15を1にする)で連続して作成し、
戻り値(ファイルハンドルまたはエラーコード)を表示します。

特殊モードの動作により、同名のファイルが2個作成されます。


## dos_curdir
コマンドライン引数で指定したドライブ(省略時はカレントドライブ)のカレントディレクトリを
`DOS _CURDIR`で調べ、結果を表示します。  
ドライブ名(ドライブレター + コロン)、ルートディレクトリのパスデリミタは含まれないため、
ルートディレクトリの場合は空文字列が表示されます。


## dos_curdrv
`DOS _CURDRV`でカレントドライブを取得し、結果を表示します。


## dos_exit2
コマンドライン引数で指定した値(16進数、省略時は0)を終了コードとして`DOS _EXIT2`で終了します。


## dos_fatchk
コマンドライン引数で指定したファイルを`DOS _FATCHK`で調べ、結果を表示します。


## dos_fgetc
コマンドライン引数で指定したファイル(省略時は標準入力)を`DOS _FGETC`で
1バイトずつ読み込み、標準出力へ出力します。


## dos_fgets
コマンドライン引数で指定したファイル(省略時は標準入力)を`DOS _FGETS`で
一行ずつ読み込み、標準出力へ出力します。


## dos_filedate
コマンドライン引数で指定したファイルのタイムスタンプを`DOS _FILEDATE`で調べ、結果を表示します。  
また、オプション指定時はファイルにタイムスタンプを設定します。

* `-t<datetime>` ... 数値で指定したタイムスタンプを設定します。


## dos_getc
`DOS _GETC`で標準入力から文字入力し、文字コードを表示します。  
ブレークチェックが行われます。


## dos_getchar
`DOS _GETCHAR`で標準入力から文字入力し、文字コードを表示します。  
入力された文字は標準出力にエコーバックされます。


## dos_getdate
`DOS _GETDATE`で日付を取得して表示します。


## dos_getenv
コマンドライン引数で指定した環境変数を`DOS _GETENV`で取得し、結果を表示します。


## dos_gets
`DOS _GETS`で標準入力から文字列入力し、結果を表示します。


## dos_gettim2
`DOS _GETTIM2`で時刻を取得して表示します。秒の値は1秒単位です。


## dos_gettime
`DOS _GETTIME`で時刻を取得して表示します。秒の値は2秒単位です。


## dos_inkey
`DOS _INKEY`で標準入力から文字入力し、文字コードを表示します。  


## dos_inpout
`DOS _INPOUT`による文字入力を行い文字コードを表示するか、または文字出力を行います。  
入力中はCTRL+Cキーで終了しますが、標準入力をリダイレクトしていると終了できない場合があります。

コマンドライン引数で動作を指定します。
- -ff ... `CODE=$ff`(キー入力)を行います。
- -fe ... `CODE=$fe`(キー先読み)を行います。
- その他 ... 文字列を1バイトずつ出力します。


## dos_keyctrl01
`DOS _KEYCTRL`によるキー入力を行い、キーコードを表示します。  
OPT.1キーまたはOPT.2キーを押し下げると終了します
(終了しない場合はどちらかのキーを押し下げたまま文字キーを押してください)。

左端の16進数はループ回数です。
先読みして入力がない状態が連続した場合は表示を省略するので、ループ回数が飛びます。  

コマンドライン引数でキー入力の方法を指定できます(無指定時は`1`)。
- `0` ... `MD=0`(キー入力)を使用します。
- `1` ... `MD=1`(キー先読み)と`MD=0`(キー入力)を組み合わせて使用します。

Human68k version 3.02では`0`(`MD=0`)で入力がない場合に入力待ちをしませんが、
ASK68K 組み込み時は入力待ちをするなど、FEP組み込み状態によって挙動が一致しません。


## dos_maketmp
コマンドライン引数で指定したファイルを`DOS _MAKETMP`で作成し、
戻り値(ファイルハンドルまたはエラーコード)と生成されたファイル名を表示します。


## dos_malloc2
コマンドライン引数で指定したモードとバイト数で`DOS _MALLOC2`でメモリを確保し、
戻り値(エラーコード)を表示します。数値はいずれも16進数で指定します。

モードに`8000`以上の値を指定した場合はバイト数の後に、確保したメモリブロックの
親のプロセス管理ポインタとして設定するアドレスを指定できます。
省略時はdos_malloc2のアドレスが使用されます。

コマンドラインの先頭で`-s`オプションを指定すると、`DOS _MALLOC2`ではなく
`DOS _S_MALLOC`でメモリを確保します。


## dos_mkdir
コマンドライン引数で指定したディレクトリを`DOS _MKDIR`で作成し、
戻り値(エラーコード)を表示します。


## dos_nameck
コマンドライン引数で指定したファイル名(パス名)を`DOS _NAMECK`で展開し、
戻り値と展開結果を表示します。


## dos_namests
コマンドライン引数で指定したファイル名(パス名)を`DOS _NAMESTS`で展開し、
戻り値と展開結果を表示します。


## dos_putchar
コマンドライン引数で指定した文字列を`DOS _PUTCHAR`で標準出力に出力します。


## dos_setdate
コマンドライン引数で指定したバイナリ形式の日付データ(16進数)を、`DOS _SETDATE`でRTCに設定します。


## dos_setenv
コマンドライン引数で`変数名=値`形式で指定した環境変数を`DOS _SETENV`で設定します。


## dos_setitm2
コマンドライン引数で指定したバイナリ形式(秒の値は1秒単位)の時刻データ(16進数)を、
`DOS _SETTIM2`でRTCに設定します。


## dos_settime
コマンドライン引数で指定したバイナリ形式(秒の値は2秒単位)の時刻データ(16進数)を、
`DOS _SETTIME`でRTCに設定します。


## dos_vernum
`DOS _VERNUM`でHuman68kのバージョンを取得し表示します。


## dos_wait
`DOS _WAIT`で終了したプロセスの終了コードを取得し表示します。


## dumpenv
環境変数をすべて表示します。  
なにかコマンドライン引数を指定すると終了時にキー入力を待ち、
終了コード1を返します(CONFIG.SYSの`EXCONFIG =`行から実行する場合用)。


## dumpstdin
`DOS _READ`で標準入力からデータを読み込み(最大256バイト)、
戻り値(入力サイズまたはエラーコード)を表示します。
また、読み込んだデータを16進数で表示します。


## dumpstupreg
起動時のMPUレジスタの値を表示します。

* データレジスタ(d0～d7) ... Human68kの仕様として不定な値になります。
* アドレスレジスタ(a0～a7) ... a5～a6はHuman68kの仕様として不定な値になります。
* スーパーバイザスタックポインタ(ssp) ... `DOS _SUPER_JSR`でサブルーチンを
  呼び出してsspを取得しています。各種情報がスタックに積まれている分、
  起動時のsspより小さい値が表示されます。
* srまたはccr ... MPUが68000の場合はsr、68010以上の場合はccrを表示します。
